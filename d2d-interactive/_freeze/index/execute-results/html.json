{
  "hash": "c3c30ee623271ffbd4452babdff5bc50",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Interactive Data Viz\"\n---\n\n# Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(RColorBrewer)\nlibrary(scales)\nlibrary(DT)\nlibrary(here)\n```\n:::\n\n\n\n## Load the NPS data\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\nca_np_long <- here(\"data_processed\", \"nps_ca-np-rec-visit_long.csv\") %>%\n  read_csv()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 4512 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Park, Month\ndbl (2): Year, NoVisitors\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\nAdd the decade \n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_np_decade <- ca_np_long %>%\n  filter(Year > 1979) %>%                # We only have 1979 in the 70s\n  mutate(Decade = Year - (Year %% 10),\n         Month = factor(Month, levels = month.abb, labels = month.abb)\n         ) %>%\n  relocate(Decade, .after = Park)\n```\n:::\n\n\n\nCompute the decadal average\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_np_decade_avg <- ca_np_decade %>%\n  group_by(Park, Decade, Month) %>%\n  summarise(Decadal_avg = as.integer(mean(NoVisitors, na.rm=TRUE))) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has regrouped the output.\nℹ Summaries were computed grouped by Park, Decade, and Month.\nℹ Output is grouped by Park and Decade.\nℹ Use `summarise(.groups = \"drop_last\")` to silence this message.\nℹ Use `summarise(.by = c(Park, Decade, Month))` for per-operation grouping\n  (`?dplyr::dplyr_by`) instead.\n```\n\n\n:::\n:::\n\n\n## Let's have a look at the data for the Channel Islands\n\nFilter for this specific park\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchannel_island_data <- ca_np_decade_avg %>% \n  filter(Park == \"Channel Islands\")\n```\n:::\n\n\nMake it an interactive table using the `DT` R package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchannel_island_data %>% \n  select(-Park) %>%\n  datatable(caption = 'Table 1: NPS Channel Island - Decadal Average of monthly visitors')\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-879a7034112667d10c1e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-879a7034112667d10c1e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Table 1: NPS Channel Island - Decadal Average of monthly visitors<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\"],[1980,1980,1980,1980,1980,1980,1980,1980,1980,1980,1980,1980,1990,1990,1990,1990,1990,1990,1990,1990,1990,1990,1990,1990,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2010,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020],[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\",\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],[10665,9716,10636,10731,14051,13731,20825,22618,16324,11876,10805,8590,23078,19505,25944,26777,33604,30981,43325,46890,32319,29264,24909,14331,25521,26500,37906,42887,46689,49070,56229,59043,44894,29007,22607,20898,16069,18748,26519,27242,30348,35435,43166,37277,28235,22103,17747,14431,13562,17055,20138,20814,21978,28994,32442,28410,26144,25485,22004,14353]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Decade<\\/th>\\n      <th>Month<\\/th>\\n      <th>Decadal_avg<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,3]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Decade\",\"targets\":1},{\"name\":\"Month\",\"targets\":2},{\"name\":\"Decadal_avg\",\"targets\":3}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchannel_island_p <- ggplot(data = channel_island_data, \n         mapping = aes(x = Month, y = Decadal_avg, group = Decade, color = as.character(Decade))) +\n  geom_line() +\n  scale_color_discrete(name = \"Decade\", palette = c(\"#C7E9C0\", \"#A1D99B\", \"#74C476\", \"#238B45\", \"#005A32\")) +\n  scale_y_continuous(labels = comma) + \n  ggtitle(\"NPS Channel Island - Decadal Average of monthly visitors\") +\n  theme_bw() +\n  theme(axis.title.x = element_blank(), axis.title.y = element_blank()) \n\nchannel_island_p\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplotly(channel_island_p, tooltip = c(\"Decade\", \"x\", \"y\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7dae3ed2842c4569d621\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7dae3ed2842c4569d621\">{\"x\":{\"data\":[{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[10665,9716,10636,10731,14051,13731,20825,22618,16324,11876,10805,8590],\"text\":[\"Month: Jan<br />Decadal_avg: 10665<br />Decade: 1980\",\"Month: Feb<br />Decadal_avg:  9716<br />Decade: 1980\",\"Month: Mar<br />Decadal_avg: 10636<br />Decade: 1980\",\"Month: Apr<br />Decadal_avg: 10731<br />Decade: 1980\",\"Month: May<br />Decadal_avg: 14051<br />Decade: 1980\",\"Month: Jun<br />Decadal_avg: 13731<br />Decade: 1980\",\"Month: Jul<br />Decadal_avg: 20825<br />Decade: 1980\",\"Month: Aug<br />Decadal_avg: 22618<br />Decade: 1980\",\"Month: Sep<br />Decadal_avg: 16324<br />Decade: 1980\",\"Month: Oct<br />Decadal_avg: 11876<br />Decade: 1980\",\"Month: Nov<br />Decadal_avg: 10805<br />Decade: 1980\",\"Month: Dec<br />Decadal_avg:  8590<br />Decade: 1980\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(199,233,192,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"1980\",\"legendgroup\":\"1980\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[23078,19505,25944,26777,33604,30981,43325,46890,32319,29264,24909,14331],\"text\":[\"Month: Jan<br />Decadal_avg: 23078<br />Decade: 1990\",\"Month: Feb<br />Decadal_avg: 19505<br />Decade: 1990\",\"Month: Mar<br />Decadal_avg: 25944<br />Decade: 1990\",\"Month: Apr<br />Decadal_avg: 26777<br />Decade: 1990\",\"Month: May<br />Decadal_avg: 33604<br />Decade: 1990\",\"Month: Jun<br />Decadal_avg: 30981<br />Decade: 1990\",\"Month: Jul<br />Decadal_avg: 43325<br />Decade: 1990\",\"Month: Aug<br />Decadal_avg: 46890<br />Decade: 1990\",\"Month: Sep<br />Decadal_avg: 32319<br />Decade: 1990\",\"Month: Oct<br />Decadal_avg: 29264<br />Decade: 1990\",\"Month: Nov<br />Decadal_avg: 24909<br />Decade: 1990\",\"Month: Dec<br />Decadal_avg: 14331<br />Decade: 1990\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(161,217,155,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"1990\",\"legendgroup\":\"1990\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[25521,26500,37906,42887,46689,49070,56229,59043,44894,29007,22607,20898],\"text\":[\"Month: Jan<br />Decadal_avg: 25521<br />Decade: 2000\",\"Month: Feb<br />Decadal_avg: 26500<br />Decade: 2000\",\"Month: Mar<br />Decadal_avg: 37906<br />Decade: 2000\",\"Month: Apr<br />Decadal_avg: 42887<br />Decade: 2000\",\"Month: May<br />Decadal_avg: 46689<br />Decade: 2000\",\"Month: Jun<br />Decadal_avg: 49070<br />Decade: 2000\",\"Month: Jul<br />Decadal_avg: 56229<br />Decade: 2000\",\"Month: Aug<br />Decadal_avg: 59043<br />Decade: 2000\",\"Month: Sep<br />Decadal_avg: 44894<br />Decade: 2000\",\"Month: Oct<br />Decadal_avg: 29007<br />Decade: 2000\",\"Month: Nov<br />Decadal_avg: 22607<br />Decade: 2000\",\"Month: Dec<br />Decadal_avg: 20898<br />Decade: 2000\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(116,196,118,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2000\",\"legendgroup\":\"2000\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[16069,18748,26519,27242,30348,35435,43166,37277,28235,22103,17747,14431],\"text\":[\"Month: Jan<br />Decadal_avg: 16069<br />Decade: 2010\",\"Month: Feb<br />Decadal_avg: 18748<br />Decade: 2010\",\"Month: Mar<br />Decadal_avg: 26519<br />Decade: 2010\",\"Month: Apr<br />Decadal_avg: 27242<br />Decade: 2010\",\"Month: May<br />Decadal_avg: 30348<br />Decade: 2010\",\"Month: Jun<br />Decadal_avg: 35435<br />Decade: 2010\",\"Month: Jul<br />Decadal_avg: 43166<br />Decade: 2010\",\"Month: Aug<br />Decadal_avg: 37277<br />Decade: 2010\",\"Month: Sep<br />Decadal_avg: 28235<br />Decade: 2010\",\"Month: Oct<br />Decadal_avg: 22103<br />Decade: 2010\",\"Month: Nov<br />Decadal_avg: 17747<br />Decade: 2010\",\"Month: Dec<br />Decadal_avg: 14431<br />Decade: 2010\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(35,139,69,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2010\",\"legendgroup\":\"2010\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[13562,17055,20138,20814,21978,28994,32442,28410,26144,25485,22004,14353],\"text\":[\"Month: Jan<br />Decadal_avg: 13562<br />Decade: 2020\",\"Month: Feb<br />Decadal_avg: 17055<br />Decade: 2020\",\"Month: Mar<br />Decadal_avg: 20138<br />Decade: 2020\",\"Month: Apr<br />Decadal_avg: 20814<br />Decade: 2020\",\"Month: May<br />Decadal_avg: 21978<br />Decade: 2020\",\"Month: Jun<br />Decadal_avg: 28994<br />Decade: 2020\",\"Month: Jul<br />Decadal_avg: 32442<br />Decade: 2020\",\"Month: Aug<br />Decadal_avg: 28410<br />Decade: 2020\",\"Month: Sep<br />Decadal_avg: 26144<br />Decade: 2020\",\"Month: Oct<br />Decadal_avg: 25485<br />Decade: 2020\",\"Month: Nov<br />Decadal_avg: 22004<br />Decade: 2020\",\"Month: Dec<br />Decadal_avg: 14353<br />Decade: 2020\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,90,50,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2020\",\"legendgroup\":\"2020\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":40.840182648401829,\"r\":7.3059360730593621,\"b\":22.648401826484022,\"l\":46.027397260273986},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"NPS Channel Island - Decadal Average of monthly visitors\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,12.6],\"tickmode\":\"array\",\"ticktext\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7.0000000000000009,8,9,10,11,12],\"categoryorder\":\"array\",\"categoryarray\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[6067.3500000000004,61565.650000000001],\"tickmode\":\"array\",\"ticktext\":[\"20,000\",\"40,000\",\"60,000\"],\"tickvals\":[20000,40000,60000],\"categoryorder\":\"array\",\"categoryarray\":[\"20,000\",\"40,000\",\"60,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"rgba(255,255,255,1)\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"layer\":\"below\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Decade\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1c2343e5065d\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"1c2343e5065d\",\"visdat\":{\"1c2343e5065d\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.9/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.34.0/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n<script src=\"site_libs/plotly-binding-4.12.0/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.25.2/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.25.2/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}